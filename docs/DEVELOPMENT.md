# DEVELOPMENT.md - 開発フェーズ・チェックリスト

## 重要ルール

> **タスク完了時は必ずこのファイルのチェックリストを更新すること**
> 
> **仕様変更があった場合は `docs/SPEC.md` も必ず更新すること**

---

## フェーズ概要

| フェーズ | 内容 | 優先度 |
|----------|------|--------|
| Phase 1 | 環境構築・基盤 | 最優先 |
| Phase 2 | 認証・ユーザー管理 | 高 |
| Phase 3 | 日記機能 | 高 |
| Phase 4 | 夢記録・夢占い機能 | 高 |
| Phase 5 | ウィッシュリスト機能 | 高 |
| Phase 6 | 振り返り機能 | 高 |
| Phase 7 | デザイン・UI調整 | 中 |
| Phase 8 | 追加実装 | 低 |

---

## Phase 1: 環境構築・基盤

### 1-1. プロジェクト初期化
- [x] Next.js プロジェクト作成（App Router）
- [x] TypeScript 設定
- [x] ESLint + Prettier 設定
- [x] ディレクトリ構成作成

### 1-2. UI基盤
- [x] shadcn/ui インストール・設定
- [x] 基本テーマ設定（白基調）
- [x] 共通レイアウトコンポーネント作成
- [x] ボトムナビ / サイドバー実装
- [x] ヘッダー実装（ロゴ、設定アイコン）

### 1-3. Supabase 設定
- [x] Supabase プロジェクト作成
- [x] 環境変数設定（.env.local）
- [x] Supabase クライアント設定

### 1-4. three.js 背景
- [x] three.js インストール
- [x] グラデーション背景実装
- [x] 星空背景実装
- [x] ページごとの背景切り替え

---

## Phase 2: 認証・ユーザー管理

### 2-1. 認証
- [x] Supabase Authentication 設定
- [x] Google OAuth 設定
- [x] ログインページ実装
- [x] ログアウト機能実装
- [x] 認証状態管理（Context or Zustand）

### 2-2. 初期登録フロー
- [ ] 初期登録ページ実装
- [ ] 生年月日入力（補足文表示）
- [ ] ニックネーム入力
- [ ] 夢占いスタイル選択
- [ ] 音声整形レベル選択

### 2-3. ユーザーテーブル
- [ ] users テーブル作成
- [ ] user_settings テーブル作成
- [ ] RLS（Row Level Security）設定

### 2-4. 設定画面
- [ ] 設定画面ルーティング
- [ ] プロフィール編集
- [ ] 記録設定（音声整形レベル、サンプル表示）
- [ ] 夢占い設定
- [ ] ログアウトボタン

---

## Phase 3: 日記機能

### 3-1. DB設計
- [ ] diaries テーブル作成
- [ ] RLS 設定

### 3-2. 日記入力画面
- [ ] 日記記録ページ実装
- [ ] テキスト入力エリア
- [ ] 保存機能

### 3-3. 音声入力
- [ ] Web Speech API 実装
- [ ] 文字起こし表示
- [ ] 「整形する」ボタン実装

### 3-4. AI整形機能
- [ ] Anthropic API 連携
- [ ] 軽め整形プロンプト
- [ ] しっかり整形プロンプト
- [ ] 箇条書き整形プロンプト
- [ ] 整形レベル切り替え

### 3-5. AI自動生成（保存時）
- [ ] 感情タグ生成
- [ ] 一行要約生成
- [ ] 「要約更新」ボタン
- [ ] 最終更新日時の保存・判定

### 3-6. 日記編集・削除
- [ ] 編集機能
- [ ] 削除機能

---

## Phase 4: 夢記録・夢占い機能

### 4-1. DB設計
- [ ] dreams テーブル作成
- [ ] dream_keywords テーブル作成
- [ ] user_glossary テーブル作成（固有名詞）
- [ ] api_usage テーブル作成（API制限用）
- [ ] RLS 設定

### 4-2. 夢記録入力画面
- [ ] 夢記録ページ実装
- [ ] テキスト入力エリア
- [ ] 音声入力（日記と共通コンポーネント化）
- [ ] 保存機能

### 4-3. キーワードタグ
- [ ] AI自動抽出
- [ ] タグ表示・編集UI

### 4-4. 夢占い機能
- [ ] 「占う」ボタン実装
- [ ] 占いスタイル別プロンプト（ユング派）
- [ ] 占いスタイル別プロンプト（フロイト派）
- [ ] 占いスタイル別プロンプト（認知的アプローチ）
- [ ] 固有名詞の反映
- [ ] 結果表示・保存

### 4-5. API制限
- [ ] APIコール回数カウント
- [ ] 1日20回制限チェック
- [ ] 制限時のエラー表示
- [ ] 0時リセット処理

### 4-6. 固有名詞管理
- [ ] 設定画面に一覧表示
- [ ] 追加機能
- [ ] 編集機能
- [ ] 削除機能

### 4-7. 夢記録編集・削除
- [ ] 編集機能
- [ ] 削除機能
- [ ] 再占い機能

---

## Phase 5: ウィッシュリスト機能

### 5-1. DB設計
- [ ] wishlists テーブル作成
- [ ] user_attributes テーブル作成（条件用属性）
- [ ] RLS 設定

### 5-2. ウィッシュリスト一覧
- [ ] 一覧ページ実装
- [ ] ステータス別表示（未達成/達成可能/達成済み）

### 5-3. ウィッシュ追加・編集
- [ ] 追加ページ実装
- [ ] タイトル・説明入力
- [ ] 実施可能条件設定UI（最大2つ、OR結合）
- [ ] 目標期限設定
- [ ] 編集機能
- [ ] 削除機能

### 5-4. 条件用属性管理
- [ ] 設定画面に一覧表示
- [ ] 属性値の登録・更新
- [ ] 属性一覧（年収、貯金額、体重など）

### 5-5. 実施可能判定
- [ ] 条件評価ロジック
- [ ] ステータス自動更新

### 5-6. 達成機能
- [ ] 「達成」ボタン
- [ ] 達成日時記録

---

## Phase 6: 振り返り機能

### 6-1. カレンダー表示
- [ ] カレンダーページ実装
- [ ] 月表示UI
- [ ] 各セルの表示（感情絵文字、●、🌙、🎉）
- [ ] PC: ホバーで要約表示
- [ ] スマホ: タップでポップオーバー

### 6-2. タイムライン表示
- [ ] タイムラインページ実装
- [ ] 日記・夢の一覧表示
- [ ] 感情絵文字表示
- [ ] 無限スクロール実装
- [ ] 年月ナビゲーター（ジャンプ機能）

### 6-3. 詳細表示
- [ ] スライドパネル実装
- [ ] 日記詳細表示
- [ ] 夢詳細表示

### 6-4. 検索・フィルタ
- [ ] 検索UI実装
- [ ] キーワード検索
- [ ] 期間フィルタ（デフォルト: 2025/1/1〜今日）
- [ ] 種類フィルタ（日記/夢）
- [ ] 感情タグフィルタ
- [ ] 夢キーワードフィルタ

---

## Phase 7: デザイン・UI調整

### 7-1. ホーム画面
- [ ] ダッシュボードUI実装
- [ ] 今日の記録セクション
- [ ] 今週の記録状況
- [ ] ウィッシュリストリマインド

### 7-2. レスポンシブ対応
- [ ] 全画面のスマホ対応確認
- [ ] タブレット対応確認

### 7-3. アニメーション調整
- [ ] three.js 背景のパフォーマンス調整
- [ ] ページ遷移アニメーション
- [ ] マイクロインタラクション

### 7-4. LP（ランディングページ）
- [ ] LP デザイン・実装
- [ ] SEO対応（meta、OGP、構造化データ）

---

## Phase 8: 追加実装

### 8-1. CSVエクスポート
- [ ] エクスポート機能実装
- [ ] 日記CSV
- [ ] 夢記録CSV
- [ ] ウィッシュリストCSV
- [ ] 選択式UI

### 8-2. アカウント削除
- [ ] 確認ダイアログ
- [ ] 全データ削除処理
- [ ] Supabase アカウント削除

### 8-3. 統計ダッシュボード
- [ ] 月ごとの記録数
- [ ] 感情の推移グラフ
- [ ] よく見る夢のワードクラウド

### 8-4. その他
- [ ] PWA対応
- [ ] エラーハンドリング改善
- [ ] ローディング状態改善

---

## 完了したフェーズ

（完了したフェーズはここに移動）

---

## 更新履歴

| 日付 | 更新者 | 内容 |
|------|--------|------|
| 2025-01-25 | - | 初版作成 |
| 2025-01-25 | Claude | Phase 1 実装完了（環境変数設定を除く） |
| 2025-01-25 | Claude | Phase 2-1 認証機能実装完了 |
